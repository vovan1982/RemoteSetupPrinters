# RemoteSetupPrinters
Удалённая установка принтеров найденных по SNMP на указнные ПК

«Удаленное подключение принтеров» было разработано для упрощения
подключения сетевых принтеров на компьютеры пользователей. 

Для запуска программы на
компьютере должен быть установлен .NET Framework не ниже версии 4.0.

ПО, запускается и работает на компьютере администратора и не требует непосредственного входа на компьютер пользователя, запускать программу необходимо от имени учетной записи имеющей административные права на компьютерах пользователей.

Данное ПО, позволяет провести поиск устройств в заданной подсети, в указанном диапазоне, по протоколу SNMP версий 1,2 и 3, в случае обнаружения устройств отвечающих на запросы, из внутренних таблиц SNMP устройства, будет выбрана необходимая информация и устройство, появится в списке для подключения. Настройки SNMP протокола хранятся в конфигурационном файле «SNMPCONFIG.cfg» который находиться в корне папки с программой. Описание конфигурационного файла находиться в 7м разделе данной инструкции.

Для удаленного подключения принтеров используются WMI запросы,  на удаленном компьютере создается пакетный файл и посредствам WMI запроса, запускается на выполнение. В пакетном файле прописываются команды по созданию порта принтера с помощью скрипта «prnport.vbs» и подключение принтера при помощи команды «rundll32.exe printui.dll, PrintUIEntry», а так же выполняется проверка подключения при помощи скрипта «prncnfg.vbs».

Для успешного подключения принтера в корневой папке программы присутствует папка «Drivers», в этой папке находятся драйвера принтеров, которые возможно подключить с помощью данной программы, если для принтера отсутствуют драйвера в этой папке, подключить его не получиться. Драйвера для новых принтеров необходимо специфическим образом подготовить и положить в эту папку, процесс подготовки драйверов будет описан ниже.

В корневой папке программы присутствует файл «typesnetprinters.cfg», в этом файле содержится информация о типе найденных устройств, если в этом файле нет информации о типе найденного устройства то устройству будет присвоен тип «UnknownType». При сканировании из таблиц SNMP устройства выбирается информация о типе данного устройства при помощи запроса к таблице с ID «1.3.6.1.2.1.1.2.0», каждый производитель использует свой идентификатор, к примеру, HP использует значение «1.3.6.1.4.1.11.2.3.9.1» что является ссылкой на другую таблицу в которой содержится информация о сетевых принтерах HP, т. о. можно утверждать что значение «1.3.6.1.4.1.11.2.3.9.1» соответствует типу сетевых принтеров фирмы HP. Информация в файле содержится в виде «значение=тип устройства», информация о каждом типе в отдельной строке.
